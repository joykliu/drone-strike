"use strict";var url="http://api.dronestre.am/data",droneApp={};mapboxgl.accessToken="pk.eyJ1Ijoiam95OTAxN21hcGJveCIsImEiOiJjaW94M2RneXQwMDJ1d2ZtNXp4a29pbTV4In0.TebEkoRfRP8E0hw_Nd3PFA",droneApp.getDrones=$.ajax({url:url,method:"GET",dataType:"jsonp"}),$.when(droneApp.getDrones).then(function(e){droneApp.filterResults=function(){e.strike.map(function(e){var r=new Array("January","February","March","April","May","June","July","August","September","October","November","December");e.date=e.date.split("-").splice(0,2),e.year=e.date[0];var n=new Date(e.date),t=r[n.getMonth()];e.displayDate=t+", "+e.year}),$("input[type=checkbox]").on("change",function(){droneApp.markers&&console.log(droneApp.markers);var r=function(e){return $("input[name="+e+"]:checked").map(function(e,r){return $(r).val()}).toArray()},n=r("year"),t=r("country"),o=["Yemen","Somalia","Pakistan"],a=["2002","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016"],i=function(r,n,t,o){if(0!==r.length)var a=r.map(function(e){return o.filter(function(r){return"year"===t?r.year===e:"country"===t?r.country===e:void 0})});else var a=n.map(function(e){return o.filter(function(r){return"year"===t?r.year===e:"country"===t?r.country===e:void 0})});var i=$.map(a,function(e){return e});e.filteredStrikes=i};i(n,a,"year",e.strike),i(t,o,"country",e.filteredStrikes),droneApp.displayStrikes(e.filteredStrikes)})},droneApp.displayStrikes=function(e){droneApp.markerArr=[],e.forEach(function(e){var r=e.lat,n=e.lon,t=void 0,o=void 0,a=void 0,i=void 0,p=void 0,d=function(){t=e.town.length&&e.country.length?e.town+e.country:e.location.length?e.location+e.country:"Unknown",o=e.narrative.length?e.narrative:e.bij_summary_short.length?e.bij_summary_short:"Awaiting detailed information on this strike...",e.bij_link.length&&(a=e.bij_summary_short.length),e.displayDate.length&&(p=e.displayDate);var r=e.deaths;i=r.length>2?r.split("-").join(" to "):r};d(),droneApp.featureObj={type:"Feature",geometry:{type:"Point",coordinates:[n,r]},properties:{title:e._id,description:'<div class="marker-content">\n                    <p>'+p+"</p>\n                    <h3>"+t+"</h3>\n                    <h4>Deaths: "+i+"</h4>\n                    <p>"+o+'</p>\n                    <a href="'+a+'">More Details...</a>\n                    </div>'}}});var r=[droneApp.featureObj];console.log(r);var n=function(){if(droneApp.markerArr.length>1){var e={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Markers",properties:{},coordinates:droneApp.markerArr}}]},r=e.features[0].geometry.coordinates,n=r.reduce(function(e,r){return e.extend(r)},new mapboxgl.LngLatBounds(r[0],r[0]));droneApp.map.fitBounds(n,{padding:50})}else droneApp.markerArr.length&&droneApp.map.flyTo({center:droneApp.markerArr[0]})};n()},droneApp.initMap=function(){droneApp.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/satellite-v9",center:[54.281023,10.913129],zoom:3,maxZoom:13})},droneApp.init=function(){droneApp.initMap(),droneApp.filterResults()},droneApp.init()});
//# sourceMappingURL=main.min.js.map
