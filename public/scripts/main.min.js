"use strict";var url="http://api.dronestre.am/data",droneApp={};mapboxgl.accessToken="pk.eyJ1Ijoiam95OTAxN21hcGJveCIsImEiOiJjaW94M2RneXQwMDJ1d2ZtNXp4a29pbTV4In0.TebEkoRfRP8E0hw_Nd3PFA",droneApp.getDrones=$.ajax({url:url,method:"GET",dataType:"jsonp"}),$.when(droneApp.getDrones).then(function(e){droneApp.filteringResult=function(){e.strike.map(function(e){var n=new Array("January","February","March","April","May","June","July","August","September","October","November","December");e.date=e.date.split("-").splice(0,2),e.year=e.date[0];var r=new Date(e.date),t=n[r.getMonth()];e.displayDate=t+", "+e.year}),$("input[type=checkbox]").on("change",function(){var n=function(e){return $("input[name="+e+"]:checked").map(function(e,n){return $(n).val()}).toArray()},r=n("year"),t=n("country"),a=["Yemen","Somalia","Pakistan"],o=["2002","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016"],i=function(n,r,t,a){if(0!==n.length)var o=n.map(function(e){return a.filter(function(n){return"year"===t?n.year===e:"country"===t?n.country===e:void 0})});else var o=r.map(function(e){return a.filter(function(n){return"year"===t?n.year===e:"country"===t?n.country===e:void 0})});var i=$.map(o,function(e){return e});e.filteredStrikes=i};i(r,o,"year",e.strike),i(t,a,"country",e.filteredStrikes)})},droneApp.initMap=function(){droneApp.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v9"})},droneApp.displayStrikes=function(){droneApp.markerArr=[];var n=function(){void 0!==e.filteredStrikes&&e.filteredStrikes.forEach(function(e){var n=e.lat,r=e.lon;console.log(e);var t=void 0,a=void 0,o=void 0,i=void 0,p=void 0,s=function(){t=e.town.length?e.town:e.location.length?e.location:"Unknown",a=e.narrative.length?e.narrative:e.bij_summary_short.length?e.bij_summary_short:"Awaiting detailed information on this strike...",e.bij_link.length&&(o=e.bij_summary_short.length),e.displayDate.length&&(p=e.displayDate);var n=function(){var n=e.deaths;i=n.length>2?n.split("-").join(" to "):n};n()};s();var d=new mapboxgl.Popup({offset:[0,0]}).setHTML('\n                        <div class="marker-content">\n                            <p>'+p+"</p>\n                            <h3>"+t+"</h3>\n                            <h4>Deaths: "+i+"</h4>\n                            <p>"+a+'</p>\n                            <a href="'+o+'">More Details...</a>\n                        </div>\n                        ');if(n.length&&r.length){var u=document.createElement("div");u.className="marker",droneApp.markers=new mapboxgl.Marker(u).setLngLat([r,n]).setPopup(d).addTo(droneApp.map),droneApp.markerArr.push([r,n])}})},r=function(){var e={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Markers",properties:{},coordinates:droneApp.markerArr}}]},n=e.features[0].geometry.coordinates,r=n.reduce(function(e,n){return e.extend(n)},new mapboxgl.LngLatBounds(n[0],n[0]));droneApp.map.fitBounds(r,{padding:50})};n(),r()},droneApp.init=function(){droneApp.filteringResult(),droneApp.initMap(),droneApp.displayStrikes()},droneApp.init()});
//# sourceMappingURL=main.min.js.map
