"use strict";var url="http://api.dronestre.am/data",droneApp={};mapboxgl.accessToken="pk.eyJ1Ijoiam95OTAxN21hcGJveCIsImEiOiJjaW94M2RneXQwMDJ1d2ZtNXp4a29pbTV4In0.TebEkoRfRP8E0hw_Nd3PFA",droneApp.getDrones=$.ajax({url:url,method:"GET",dataType:"jsonp"}),$.when(droneApp.getDrones).then(function(e){droneApp.markerData=[],droneApp.mapArr=[],droneApp.listArr=[],droneApp.dataCleanUp=function(){var r=e.strike.filter(function(e){if(e.country)return"Pakistan"===e.country});r.map(function(e){var r=new Array("January","February","March","April","May","June","July","August","September","October","November","December");e.date=e.date.split("-").splice(0,2),e.year=e.date[0];var n=new Date(e.date),t=r[n.getMonth()];e.displayDate=t+", "+e.year,e.lat||e.lon?droneApp.mapArr.push(e):droneApp.listArr.push(e)})},droneApp.displayStrikes=function(e){e.forEach(function(e){var r=void 0,n=void 0,t=void 0,o=void 0,a=void 0,p=void 0,i=void 0,d=void 0,s=function(){r=e.lat,n=e.lon,t=e.town.length&&e.country.length?e.town+", "+e.country:e.location.length?e.location+", "+e.country:"Unknown",o=e.narrative.length?e.narrative:e.bij_summary_short.length?e.bij_summary_short:"Awaiting detailed information on this strike...",e.bij_link.length&&(a=e.bij_summary_short.length),e.displayDate&&(i=e.displayDate);var s=e.deaths;p=s.length>2?s.split("-").join(" to "):s,e.min_deaths&&(d=e.min_deaths)};s();var l={type:"Feature",geometry:{type:"Point",coordinates:[n,r]},properties:{description:'<div class="marker-content">\n                    <p>'+i+"</p>\n                    <h3>"+t+"</h3>\n                    <h4>Deaths: "+p+"</h4>\n                    <p>"+o+'</p>\n                    <a href="'+a+'">More Details...</a>\n                    </div>',iconSize:[40,40],minDeaths:d}};droneApp.markerData.push(l)});var r={type:"FeatureCollection",features:droneApp.markerData};droneApp.map.on("load",function(){droneApp.map.addSource("strikes",{type:"geojson",data:r});droneApp.map.addLayer({id:"strikes",type:"circle",source:"strikes",paint:{"circle-radius":10,"circle-color":{property:"minDeaths"}}}),console.log(droneApp.map)});var n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});droneApp.map.on("mousemove",function(e){var r=droneApp.map.queryRenderedFeatures(e.point,{layers:["strikes"]});if(droneApp.map.getCanvas().style.cursor=r.length?"pointer":"",!r.length)return void n.remove();var t=r[0];n.setLngLat(t.geometry.coordinates).setHTML(t.properties.description).addTo(droneApp.map)})},droneApp.initMap=function(){droneApp.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/satellite-v9",center:[54.281023,10.913129],zoom:3,maxZoom:13})},droneApp.init=function(){droneApp.initMap(),droneApp.dataCleanUp(),droneApp.displayStrikes(droneApp.mapArr)},droneApp.init()});
//# sourceMappingURL=main.min.js.map
